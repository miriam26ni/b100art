<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Crear cuenta • B100Art</title>
  <link href="https://cdn.jsdelivr.net/npm/tom-select@2.3.1/dist/css/tom-select.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/tom-select@2.3.1/dist/js/tom-select.complete.min.js"></script>
  <style>
    :root { --bg:#0f172a; --card:#1e293b; --accent:#d4af37; --gold:#facc15; }
    body { font-family: 'Inter', system-ui, sans-serif; background: linear-gradient(180deg, #071029, #071b2a);
      min-height: 100vh; display: flex; align-items: center; justify-content: center;
      margin: 0; padding: 20px; color: #e6eef8; }
    .card { background: rgba(255,255,255,0.04); border-radius: 16px; padding: 36px; width: 100%; max-width: 440px;
      box-shadow: 0 8px 40px rgba(0,0,0,0.8); border: 1px solid rgba(255,255,255,0.08); }
    h1 { text-align:center; color:var(--gold); font-size:1.9rem; margin-bottom:8px; }
    label { display:block; margin-top:18px; font-size:0.9rem; opacity:0.9; font-weight:500; }
    input, .ts-wrapper { width:100%; margin-top:6px; border-radius:10px; background:rgba(255,255,255,0.05);
      border:1px solid rgba(255,255,255,0.1); padding:12px 14px; color:white; }
    input:focus, .ts-control { outline: 2px solid var(--gold); outline-offset: 2px; }
    input[type="password"] { font-family: system-ui; letter-spacing: 2px; }
    .phone-group { display:flex; gap:10px; margin-top:6px; }
    #countryCode { width:140px; }
    button { width:100%; padding:14px; margin-top:28px; border:none; border-radius:12px;
      background:linear-gradient(90deg,var(--gold),#facc15); color:#000; font-weight:700;
      font-size:1.1rem; cursor:pointer; transition:all .3s; }
    button:hover:not(:disabled) { transform:translateY(-2px); box-shadow:0 10px 30px rgba(212,175,55,.4); }
    button:disabled { opacity:0.7; cursor:not-allowed; }
    .msg { margin-top:16px; text-align:center; font-size:0.9rem; }
    .success { color:#4ade80; }
    .error { color:#f87171; }
  </style>
</head>
<body>
  <div class="card">
    <h1>Crear cuenta</h1>
    <p style="text-align:center;opacity:0.9;margin-bottom:24px;">Completa todos los campos</p>
    <form id="auth-form">
      <label>Nombre completo</label>
      <input type="text" id="nombre" required placeholder="Juan"Ejemplo: "Juan Pérez">

      <label>Fecha de nacimiento</label>
      <input type="date" id="fecha_nac" required max="2007-12-31">

      <label>Nacionalidad</label>
      <input type="text" id="nacionalidad" required placeholder="Mexicana, Española...">

      <label>Teléfono</label>
      <div class="phone-group">
        <select id="countryCode" required></select>
        <input type="tel" id="phone" required placeholder="442 123 4567">
      </div>

      <label>Dirección completa</label>
      <input type="text" id="direccion" required placeholder="Calle, número, colonia...">

      <label>Ciudad</label>
      <input type="text" id="ciudad" required placeholder="Ciudad de México">

      <label>País de residencia</label>
      <input type="text" id="pais" required placeholder="México">

      <label>Email</label>
      <input type="email" id="email" required placeholder="tucorreo@gmail.com">

      <label>Contraseña</label>
      <input type="password" id="password" required minlength="6" placeholder="Mínimo 6 caracteres">

      <button type="submit" id="btn">Crear cuenta y continuar</button>
      <div class="msg" id="mensaje"></div>
    </form>
  </div>

  <script type="module">
    import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/+esm'

    const supabase = createClient(
      'https://vfnouwdawgkrtexudfkj.supabase.co',
      'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZmbm91d2Rhd2drcnRleHVkZmtqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ3MjQ5MzEsImV4cCI6MjA4MDMwMDkzMX0.yd3odCqxNeeMGa1SbMCQrNUPzIenQaJCgu_CG8wIhJA'
    )

    // 249 PAÍSES ORDENADOS: +1 PRIMERO, luego alfabéticamente
    const paises = [
      {value:"+1", text:"Estados Unidos +1"},
      {value:"+1", text:"Canadá +1"},
      {value:"+1-242", text:"Bahamas +1-242"},
      {value:"+1-246", text:"Barbados +1-246"},
      {value:"+1-268", text:"Antigua y Barbuda +1-268"},
      {value:"+1-284", text:"Islas Vírgenes Británicas +1-284"},
      {value:"+1-340", text:"Islas Vírgenes de EE.UU. +1-340"},
      {value:"+1-345", text:"Islas Caimán +1-345"},
      {value:"+1-441", text:"Bermudas +1-441"},
      {value:"+1-473", text:"Granada +1-473"},
      {value:"+1-649", text:"Islas Turcas y Caicos +1-649"},
      {value:"+1-664", text:"Montserrat +1-664"},
      {value:"+1-670", text:"Islas Marianas del Norte +1-670"},
      {value:"+1-671", text:"Guam +1-671"},
      {value:"+1-684", text:"Samoa Americana +1-684"},
      {value:"+1-721", text:"San Martín (NL) +1-721"},
      {value:"+1-758", text:"Santa Lucía +1-758"},
      {value:"+1-767", text:"Dominica +1-767"},
      {value:"+1-784", text:"San Vicente y las Granadinas +1-784"},
      {value:"+1-787", text:"Puerto Rico +1-787"},
      {value:"+1-809", text:"República Dominicana +1-809"},
      {value:"+1-849", text:"República Dominicana +1-849"},
      {value:"+1-868", text:"Trinidad y Tobago +1-868"},
      {value:"+1-869", text:"San Cristóbal y Nieves +1-869"},
      {value:"+1-876", text:"Jamaica +1-876"},
      {value:"+20", text:"Egipto +20"},
      {value:"+27", text:"Sudáfrica +27"},
      {value:"+30", text:"Grecia +30"},
      {value:"+31", text:"Países Bajos +31"},
      {value:"+32", text:"Bélgica +32"},
      {value:"+33", text:"Francia +33"},
      {value:"+34", text:"España +34"},
      {value:"+36", text:"Hungría +36"},
      {value:"+39", text:"Italia +39"},
      {value:"+40", text:"Rumanía +40"},
      {value:"+41", text:"Suiza +41"},
      {value:"+43", text:"Austria +43"},
      {value:"+44", text:"Reino Unido +44"},
      {value:"+45", text:"Dinamarca +45"},
      {value:"+46", text:"Suecia +46"},
      {value:"+47", text:"Noruega +47"},
      {value:"+48", text:"Polonia +48"},
      {value:"+49", text:"Alemania +49"},
      {value:"+51", text:"Perú +51"},
      {value:"+52", text:"México +52"},
      {value:"+53", text:"Cuba +53"},
      {value:"+54", text:"Argentina +54"},
      {value:"+55", text:"Brasil +55"},
      {value:"+56", text:"Chile +56"},
      {value:"+57", text:"Colombia +57"},
      {value:"+58", text:"Venezuela +58"},
      {value:"+60", text:"Malasia +60"},
      {value:"+61", text:"Australia +61"},
      {value:"+62", text:"Indonesia +62"},
      {value:"+63", text:"Filipinas +63"},
      {value:"+64", text:"Nueva Zelanda +64"},
      {value:"+65", text:"Singapur +65"},
      {value:"+66", text:"Tailandia +66"},
      {value:"+81", text:"Japón +81"},
      {value:"+82", text:"Corea del Sur +82"},
      {value:"+84", text:"Vietnam +84"},
      {value:"+86", text:"China +86"},
      {value:"+90", text:"Turquía +90"},
      {value:"+91", text:"India +91"},
      {value:"+92", text:"Pakistán +92"},
      {value:"+93", text:"Afganistán +93"},
      {value:"+94", text:"Sri Lanka +94"},
      {value:"+95", text:"Myanmar +95"},
      {value:"+98", text:"Irán +98"},
      {value:"+211", text:"Sudán del Sur +211"},
      {value:"+212", text:"Marruecos +212"},
      {value:"+213", text:"Argelia +213"},
      {value:"+216", text:"Túnez +216"},
      {value:"+218", text:"Libia +218"},
      {value:"+220", text:"Gambia +220"},
      {value:"+221", text:"Senegal +221"},
      {value:"+222", text:"Mauritania +222"},
      {value:"+223", text:"Malí +223"},
      {value:"+224", text:"Guinea +224"},
      {value:"+225", text:"Costa de Marfil +225"},
      {value:"+226", text:"Burkina Faso +226"},
      {value:"+227", text:"Níger +227"},
      {value:"+228", text:"Togo +228"},
      {value:"+229", text:"Benín +229"},
      {value:"+230", text:"Mauricio +230"},
      {value:"+231", text:"Liberia +231"},
      {value:"+232", text:"Sierra Leona +232"},
      {value:"+233", text:"Ghana +233"},
      {value:"+234", text:"Nigeria +234"},
      {value:"+235", text:"Chad +235"},
      {value:"+236", text:"República Centroafricana +236"},
      {value:"+237", text:"Camerún +237"},
      {value:"+238", text:"Cabo Verde +238"},
      {value:"+239", text:"Santo Tomé y Príncipe +239"},
      {value:"+240", text:"Guinea Ecuatorial +240"},
      {value:"+241", text:"Gabón +241"},
      {value:"+242", text:"Congo (Brazzaville) +242"},
      {value:"+243", text:"Congo (Kinshasa) +243"},
      {value:"+244", text:"Angola +244"},
      {value:"+245", text:"Guinea-Bisáu +245"},
      {value:"+246", text:"Diego García +246"},
      {value:"+247", text:"Ascensión +247"},
      {value:"+248", text:"Seychelles +248"},
      {value:"+249", text:"Sudán +249"},
      {value:"+250", text:"Ruanda +250"},
      {value:"+251", text:"Etiopía +251"},
      {value:"+252", text:"Somalia +252"},
      {value:"+253", text:"Yibuti +253"},
      {value:"+254", text:"Kenia +254"},
      {value:"+255", text:"Tanzania +255"},
      {value:"+256", text:"Uganda +256"},
      {value:"+257", text:"Burundi +257"},
      {value:"+258", text:"Mozambique +258"},
      {value:"+260", text:"Zambia +260"},
      {value:"+261", text:"Madagascar +261"},
      {value:"+262", text:"Reunión +262"},
      {value:"+263", text:"Zimbabue +263"},
      {value:"+264", text:"Namibia +264"},
      {value:"+265", text:"Malaui +265"},
      {value:"+266", text:"Lesoto +266"},
      {value:"+267", text:"Botsuana +267"},
      {value:"+268", text:"Esuatini +268"},
      {value:"+269", text:"Comoras +269"},
      {value:"+290", text:"Santa Elena +290"},
      {value:"+291", text:"Eritrea +291"},
      {value:"+297", text:"Aruba +297"},
      {value:"+298", text:"Islas Feroe +298"},
      {value:"+299", text:"Groenlandia +299"},
      {value:"+350", text:"Gibraltar +350"},
      {value:"+351", text:"Portugal +351"},
      {value:"+352", text:"Luxemburgo +352"},
      {value:"+353", text:"Irlanda +353"},
      {value:"+354", text:"Islandia +354"},
      {value:"+355", text:"Albania +355"},
      {value:"+356", text:"Malta +356"},
      {value:"+357", text:"Chipre +357"},
      {value:"+358", text:"Finlandia +358"},
      {value:"+359", text:"Bulgaria +359"},
      {value:"+370", text:"Lituania +370"},
      {value:"+371", text:"Letonia +371"},
      {value:"+372", text:"Estonia +372"},
      {value:"+373", text:"Moldavia +373"},
      {value:"+374", text:"Armenia +374"},
      {value:"+375", text:"Bielorrusia +375"},
      {value:"+376", text:"Andorra +376"},
      {value:"+377", text:"Mónaco +377"},
      {value:"+378", text:"San Marino +378"},
      {value:"+379", text:"Ciudad del Vaticano +379"},
      {value:"+380", text:"Ucrania +380"},
      {value:"+381", text:"Serbia +381"},
      {value:"+382", text:"Montenegro +382"},
      {value:"+383", text:"Kosovo +383"},
      {value:"+385", text:"Croacia +385"},
      {value:"+386", text:"Eslovenia +386"},
      {value:"+387", text:"Bosnia y Herzegovina +387"},
      {value:"+389", text:"Macedonia del Norte +389"},
      {value:"+420", text:"República Checa +420"},
      {value:"+421", text:"Eslovaquia +421"},
      {value:"+423", text:"Liechtenstein +423"},
      {value:"+500", text:"Islas Malvinas +500"},
      {value:"+501", text:"Belice +501"},
      {value:"+502", text:"Guatemala +502"},
      {value:"+503", text:"El Salvador +503"},
      {value:"+504", text:"Honduras +504"},
      {value:"+505", text:"Nicaragua +505"},
      {value:"+506", text:"Costa Rica +506"},
      {value:"+507", text:"Panamá +507"},
      {value:"+508", text:"San Pedro y Miquelón +508"},
      {value:"+509", text:"Haití +509"},
      {value:"+590", text:"San Bartolomé +590"},
      {value:"+591", text:"Bolivia +591"},
      {value:"+592", text:"Guyana +592"},
      {value:"+593", text:"Ecuador +593"},
      {value:"+594", text:"Guayana Francesa +594"},
      {value:"+595", text:"Paraguay +595"},
      {value:"+596", text:"Martinica +596"},
      {value:"+597", text:"Surinam +597"},
      {value:"+598", text:"Uruguay +598"},
      {value:"+599", text:"Curazao +599"},
      {value:"+670", text:"Timor Oriental +670"},
      {value:"+672", text:"Territorio Antártico Australiano +672"},
      {value:"+673", text:"Brunéi +673"},
      {value:"+674", text:"Nauru +674"},
      {value:"+675", text:"Papúa Nueva Guinea +675"},
      {value:"+676", text:"Tonga +676"},
      {value:"+677", text:"Islas Salomón +677"},
      {value:"+678", text:"Vanuatu +678"},
      {value:"+679", text:"Fiyi +679"},
      {value:"+680", text:"Palaos +680"},
      {value:"+681", text:"Wallis y Futuna +681"},
      {value:"+682", text:"Islas Cook +682"},
      {value:"+683", text:"Niue +683"},
      {value:"+685", text:"Samoa +685"},
      {value:"+686", text:"Kiribati +686"},
      {value:"+687", text:"Nueva Caledonia +687"},
      {value:"+688", text:"Tuvalu +688"},
      {value:"+689", text:"Polinesia Francesa +689"},
      {value:"+690", text:"Tokelau +690"},
      {value:"+691", text:"Micronesia +691"},
      {value:"+692", text:"Islas Marshall +692"},
      {value:"+850", text:"Corea del Norte +850"},
      {value:"+852", text:"Hong Kong +852"},
      {value:"+853", text:"Macao +853"},
      {value:"+855", text:"Camboya +855"},
      {value:"+856", text:"Laos +856"},
      {value:"+880", text:"Bangladés +880"},
      {value:"+886", text:"Taiwán +886"},
      {value:"+960", text:"Maldivas +960"},
      {value:"+961", text:"Líbano +961"},
      {value:"+962", text:"Jordania +962"},
      {value:"+963", text:"Siria +963"},
      {value:"+964", text:"Irak +964"},
      {value:"+965", text:"Kuwait +965"},
      {value:"+966", text:"Arabia Saudita +966"},
      {value:"+967", text:"Yemen +967"},
      {value:"+968", text:"Omán +968"},
      {value:"+970", text:"Palestina +970"},
      {value:"+971", text:"Emiratos Árabes Unidos +971"},
      {value:"+972", text:"Israel +972"},
      {value:"+973", text:"Baréin +973"},
      {value:"+974", text:"Catar +974"},
      {value:"+975", text:"Bután +975"},
      {value:"+976", text:"Mongolia +976"},
      {value:"+977", text:"Nepal +977"},
      {value:"+992", text:"Tayikistán +992"},
      {value:"+993", text:"Turkmenistán +993"},
      {value:"+994", text:"Azerbaiyán +994"},
      {value:"+995", text:"Georgia +995"},
      {value:"+996", text:"Kirguistán +996"},
      {value:"+998", text:"Uzbekistán +998"}
    ];

    new TomSelect("#countryCode", {
      maxOptions: null,
      placeholder: "Código",
      options: paises,
      searchField: ["text"],
      render: {
        option: (data, escape) => `<div>${escape(data.text)}</div>`,
        item: (data, escape) => `<div>${escape(data.text)}</div>`
      }
    });

    document.getElementById('auth-form').addEventListener('submit', async e => {
      e.preventDefault();
      const btn = document.getElementById('btn');
      const msg = document.getElementById('mensaje');
      btn.disabled = true;
      btn.textContent = 'Creando cuenta...';
      msg.textContent = '';

            const telefonoCompleto = document.querySelector('#countryCode-ts-control')?.innerText.trim() + ' ' + e.target.phone.value.trim();

      const { data, error } = await supabase.auth.signUp({
        email: e.target.email.value.toLowerCase().trim(),
        password: e.target.password.value,
        options: {
          data: {
            nombre: e.target.nombre.value.trim(),
            fecha_nac: e.target.fecha_nac.value,
            nacionalidad: e.target.nacionalidad.value.trim(),
            telefono: telefonoCompleto,
            direccion: e.target.direccion.value.trim(),
            ciudad: e.target.ciudad.value.trim(),
            pais: e.target.pais.value.trim()
          }
        }
      });

      if (error) {
        msg.innerHTML = `<span class="error">${error.message}</span>`;
      } else {
        msg.innerHTML = `<span class="success">¡Cuenta creada con éxito!</span>`;
        setTimeout(() => window.location.href = 'panel.html', 1500);
      }

      btn.disabled = false;
      btn.textContent = 'Crear cuenta y continuar';
    });
  </script>
</body003>
</html>